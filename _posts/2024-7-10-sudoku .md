---
layout: post
title: c#으로 스도쿠(Sudoku) 게임 만들기-1
date : 2024-07-10
author : "enmael"
categories: blog
---
<h3>●스도쿠 게임 만들기 </h3>
<span style="font-size: 15px;">
  스도쿠 게임은 가로x 세로 9x9의 칸에 1~9까지의 숫자들 가로, 세로 중복 없이 채우는 게임 입니다.
이렇게 채운 3x3의 블록이 기본이 되며 이 블록 또한 1~9 까지의 숫자를 중복없이 채우면 퍼즐이 완성되는 게임 입니다
  (그림1 대충 스도쿠 퍼즐 그림 하나)
</span>

<span style="font-size: 15px;">
  스도쿠 게임을 만들기 위해서는 밑에 그림2에 처럼 5가지의 과정을 완성해야합니다
  (그림2 스도쿠 퍼즐 만드는 그림)
</span>

<span style="font-size: 15px;">
  첫번째 중복없는 3x3의 블록 그러니까 배열을 하나 만드는것
  두번째 중복없는 배열을 잘라서 가로 칸을 채우는것
  세번째 중복없는 배열을 잘라서 세로 칸을 채우는것
  네번째 이렇게 만들어진 배열들을 모두 합쳐서 하나의 9x9이 배열을 만드는것
  다섯번째 이렇게 만들어진 배열을 가지고 게임을 플레이하는것 

  이렇게 5개의 과정을 수행해야합니다 
  
</span>
<h4>1.중복없는 3X3 배열 만들기</h4>

<span style="font-size: 15px;">
    중복없는 3X3 배열을 만들기 위해서는 랜덤 함수를 이용해야 합니다.
  하지만 랜덤 함수를 이용해서 중복없는 배열은 만들수 없기 때문에 이 문제를 해결하기 위해 
  피셔에이츠 셔플 알고리  즘 이라는것을 사용 합니다 
</span>
<h5>1.1피셔에이츠 셔플 알고리즘</h5>

<span style="font-size: 15px;">
   피셔-예이츠 셔플 알고리즘(Fisher-Yates shuffle algorithm)은 배열을 무작위로 썩는 알고리즘으로 
  임의의 순서로 배열의 요소들을 섞어 중복되지 않는 배열을 만드는 알고리즘 입니다.
</span>

<span style="font-size: 15px;">
   피셔에이츠 알고리즘 설명은 아래의 그림과 같습니다
   (그림3 피셔에이츠 셔플 알고리즘 설명 그림)
</span>

```csharp
class Basic
    {
        private int[] array = new int[9] { 1, 2, 3, 4, 5, 6, 7, 8, 9 };
        private int[,] array2 = new int[3, 3];

        public Basic()
        {
            Random random = new Random();

            for (int i = array.Length - 1; i > 0; i--)
            {
                int j = random.Next(0, i + 1);

                int temp = array[i];
                array[i] = array[j];
                array[j] = temp;
            }


            int a = 0;
            for (int i = 0; i < array2.GetLength(0); i++)
            {
                for (int j = 0; j < array2.GetLength(1); j++)
                {
                    array2[i, j] = array[a];
                    a++;
                }
            }

        }

        public int Array2(int x, int y)
        {
            int note = array2[x, y];
            return note;
        }

        public int rows()
        {
            int note = array2.GetLength(0);
            return note;
        }

        public int cols()
        {
            int note = array2.GetLength(1);
            return note;
        }

    }
```
<span style="font-size: 15px;">
   코드1 피셔에이츠 셔플 알고리즘을 이용해서 3x3배열만들기 
</span>
<span style="font-size: 15px;">

</span>
<h4>2.세로 만들기</h4>

<h4>3.가로 만들기</h4>
<h4>4.합치기</h4>

```csharp
 rows1 = sudoku1.GetLength(0);
 cols1 = sudoku1.GetLength(1);
 rows2 = sudoku2.GetLength(0);
 cols2 = sudoku2.GetLength(1);
 rows3 = sudoku3.GetLength(0);
 cols3 = sudoku3.GetLength(1);

 int[,] newSudoku = new int[rows1 + rows2 + rows3, cols1];

 for (int i = 0; i < rows1; i++)
 {
     for (int j = 0; j < cols1; j++)
     {
         newSudoku[i, j] = sudoku1[i, j];
     }
 }

 for (int i = 0; i < rows2; i++)
 {
     for (int j = 0; j < cols2; j++)
     {
         newSudoku[i + rows1, j] = sudoku2[i, j];
     }
 }

 for (int i = 0; i < rows3; i++)
 {
     for (int j = 0; j < cols2; j++)
     {
         newSudoku[i + rows1 + rows2, j] = sudoku3[i, j];
     }
 }
<span style="font-size: 15px;">
   코드00 
</span>

<span style="font-size: 15px;">
   코드00 는 위에서 만들어진 3x9의 2차원배열인  sudoku1, sudoku2, sudoku3를 합쳐서 하나의 새로운 9X9배열  newSudoku 에 붙여 넣는 과정 입니다 
</span>
```
<h4>5.게임 플레이</h4>

<h5>5.1 빈 공간 배열 만들기</h5>

```csharp
//복사
int[,] copySudoku = new int[9, 9];
for (int i = 0; i < copySudoku.GetLength(0); i++)
{
    for (int j = 0; j < copySudoku.GetLength(1); j++)
        copySudoku[i, j] = newSudoku[i, j];
}

//랜덤 좌표를 빈공간으로 만들기
int number1 = 0;
int number2 = 0;
Random random = new Random();
for (int i = 0; i < 15; i++)
{
    number1 = random.Next(0, 9);
    number2 = random.Next(0, 9);
    copySudoku[number1, number2] = 0;
}
```
<span style="font-size: 15px;">
   코드00 
</span>

<span style="font-size: 15px;">
   코드00는 게임 플레이 필요한 답안지를 제작하는 과정으로 
 copySudoku라는 새로운 배열을 생성하여 랜덤 함수를 이용하여 
  2차원배열을 인덱스 값을 받아서 그곳의 값만 0으로 바꿔 버리는 코드 입니다.
</span>

```csharp
int Zero = 0;
for (int i = 0; i < copySudoku.GetLength(0); i++)
{
    for (int j = 0; j < copySudoku.GetLength(1); j++)
    {
        if (copySudoku[i, j] == 0)
        {
            Zero++;
        }
    }
}
int Zero2 = 0;
Zero2 = Zero;
```
<span style="font-size: 15px;">
   코드00 
</span>

<span style="font-size: 15px;">
   코드00 은 빈공간의 갯수를 Zero라는 변수로 저장하여 Zero2에 저장을 합니다.
</span>

<h5>5.2 게임플레이</h5>

```csharp
 Console.CursorVisible = false; //콘솔창 커서 제거 
 //시작위치
 int x = 16;
 int y = 16;
 ConsoleKeyInfo key; //키보드 사용
 int start = 0; // 화면 대기용으로 만든거
 int memo = 0; //임시적으로 숫자를 저장
whlie(true)
{
  if (start < 20)
  {
    //시작화면
  }
  else
  {
  //작동
  }
  //화면초기화
}
 //
```
<span style="font-size: 15px;">
   코드00 
</span>

<span style="font-size: 15px;">
   코드00 시작화면, 작동, 화면초기화 3개로 나누어져있습니다.
</span>

```csharp
if (start < 20)
{
    #region 시작화면
    Console.SetCursorPosition(5, 3);
    Console.WriteLine("SUDOKU");
    Console.WriteLine(" ");
    Console.SetCursorPosition(5, 5);
    Console.WriteLine("Game");
    Console.SetCursorPosition(5, 6);
    Console.WriteLine("Starting");
    
    start++;
    #endregion
}
```

<span style="font-size: 15px;">
   코드00 
</span>

<span style="font-size: 15px;">
   코드00 시작화면은 그림0 의 화면이 나오며 start 변수의 값이 20을 넘으면 게임플레이 화면으로 넘어 갑니다.
</span>

```csharp
else
{
  if(Zero!=0)
  {
    //정보 표시

    //스도쿠 판

    //키보드 이벤트
  }
  else if (Zero == 0) 
  {
    //게임종료후 점수 판정 
  }
}
```

<span style="font-size: 15px;">
   코드00 
</span>

<span style="font-size: 15px;">
   코드00 작동부 로 정보 표시, 스도쿠 판, 키보드 이벤트, 게임종료후 점수 판정으로 나누어집니다.
</span>

```csharp
#region 스도쿠 판
for (int i = 0; i < copySudoku.GetLength(1); i++)
{
    for (int j = 0; j < copySudoku.GetLength(0); j++)
    {
        if (copySudoku[i, j] == 0)
        {
            Console.Write("□");
        }
        else if (copySudoku[i, j] == 1)
        {
            Console.Write("①");
        }
        else if (copySudoku[i, j] == 2)
        {
            Console.Write("②");
        }
        else if (copySudoku[i, j] == 2)
        {
            Console.Write("②");
        }
        else if (copySudoku[i, j] == 3)
        {
            Console.Write("③");
        }
        else if (copySudoku[i, j] == 4)
        {
            Console.Write("④");
        }
        else if (copySudoku[i, j] == 5)
        {
            Console.Write("⑤");
        }
        else if (copySudoku[i, j] == 6)
        {
            Console.Write("⑥");
        }
        else if (copySudoku[i, j] == 7)
        {
            Console.Write("⑦");
        }
        else if (copySudoku[i, j] == 8)
        {
            Console.Write("⑧");
        }
        else if (copySudoku[i, j] == 9)
        {
            Console.Write("⑨");
        }
        else
        {
            Console.Write(copySudoku[i, j] + " ");
        }

    }

    Console.WriteLine();
}
#endregion
```

<span style="font-size: 15px;">
   코드00 
</span>

<span style="font-size: 15px;">
   코드00 스도쿠판 은 copySudoku 배열을 가지고 빈공간 그러니까 0은□, 1는(은)①, 2는(은)②, 3는(은)③, 4는(은)④, 5는(은)⑤, 6는(은)⑥, 7는(은)⑦ 8는(은)⑧, 9는(은)⑨ 으로 변환해서 그림0 처럼 콘솔창에 표시되게 해주는 코드 입니다.
</span>


```csharp
    #region 키보드 이벤트
    //Q : 1, W : 2, E : 3
    //A : 4, S : 5, D : 6
    //Z : 7, X : 8, C : 9
    //enter : 입력
    //Spacebar : 지우기 
    Console.SetCursorPosition(x, y);
    Console.WriteLine("▲");
    key = Console.ReadKey();
    switch (key.Key)
    {
        case ConsoleKey.UpArrow:
            if (y > 7)
            {
                y--;
            }
            break;
        case ConsoleKey.DownArrow:
            if (y <= 14)
            {
                y++;
            }
            break;
        case ConsoleKey.LeftArrow:
            if (x > 0)
            {
                x = x - 2;
            }
            break;
        case ConsoleKey.RightArrow:
            if (x <= 15)
            {
                x = x + 2;
            }
            break;
        case ConsoleKey.Q:
            if (copySudoku[y - 7, x / 2] == 0)
            {
                memo = 1;
                num2[0] = 0;
            }
            break;
        case ConsoleKey.W:
            if (copySudoku[y - 7, x / 2] == 0)
            {
                memo = 2;
                num2[1] = 0;
            }
            break;
        case ConsoleKey.E:
            if (copySudoku[y - 7, x / 2] == 0)
            {
                memo = 3;
                num2[2] = 0;
            }
            break;
        case ConsoleKey.A:
            if (copySudoku[y - 7, x / 2] == 0)
            {
                memo = 4;
                num2[3] = 0;
            }
            break;
        case ConsoleKey.S:
            if (copySudoku[y - 7, x / 2] == 0)
            {
                memo = 5;
                num2[4] = 0;
            }
            break;
        case ConsoleKey.D:
            if (copySudoku[y - 7, x / 2] == 0)
            {
                memo = 6;
                num2[5] = 0;
            }
            break;
        case ConsoleKey.Z:
            if (copySudoku[y - 7, x / 2] == 0)
            {
                memo = 7;
                num2[6] = 0;
            }
            break;
        case ConsoleKey.X:
            if (copySudoku[y - 7, x / 2] == 0)
            {
                memo = 8;
                num2[7] = 0;
            }
            break;
        case ConsoleKey.C:
            if (copySudoku[y - 7, x / 2] == 0)
            {
                memo = 9;
                num2[8] = 0;
            }
            break;
        case ConsoleKey.Enter:
            if (memo != 0)
            {
                if (copySudoku[y - 7, x / 2] == 0)
                {
                    copySudoku[y - 7, x / 2] = memo;
                    Zero--;
                    memo = 0;
                    //숫자 초기화
                    for(int i  =0; i < num2.Length; i++)
                    {
                        num2[i] = num3[i];
                    }
                }
                
            }
            break;
        case ConsoleKey.Spacebar:
            //입력 오타 초기화
            memo = 0;
            for (int i = 0; i < num2.Length; i++)
            {
                num2[i] = num3[i];
            }
            break;
    }
    #endregion
}
```

<span style="font-size: 15px;">
   코드00 
</span>

<span style="font-size: 15px;">
   코드00 은 키보드 방향키로 ▲을 움직이며, 주석에 표시된 키를 입력하면 숫자를 임시 적으로 memo이라는 변수에 저장 하고 맞으면 Enter눌러서 빈공간에 값을 입력하고 Zero 변수의 값을 --하여 빈공간을 계수를 카운트 합니다. 그리고 틀리면 Spacebar 를 눌러서memo에 저장되는 값을 초기화 합니다.
</span>

```csharp
 #region 게임종료후 점수 판정
 int sudokuAnswer = Zero2;
 for (int i = 0; i < copySudoku.GetLength(0); i++)
 {
     for (int j = 0; j < copySudoku.GetLength(1); j++)
     {
         if (newSudoku[i, j] != copySudoku[i, j])
         {
             sudokuAnswer--;
         }
     }
 }
 Console.SetCursorPosition(5, 3);
 if (sudokuAnswer == 0)
 {
     Console.WriteLine("Game Over");

 }
 else if (sudokuAnswer == Zero2)
 {
     Console.WriteLine("All Clear!!!");

 }
 else if (sudokuAnswer > 0)
 {
     Console.WriteLine(sudokuAnswer + "개");
     Console.WriteLine(" 맞추셨습니다.");

 }
 #endregion
```

<span style="font-size: 15px;">
   코드00 
</span>

<span style="font-size: 15px;">
   코드00 게임종료후 점수를 판정하는 코드로 Zero2 라는 코드에 저장되어 있는 값을 sudokuAnswer이라는 변수에 저장 입력된값이 원래 생성되어있는 newSudoku 라는배열에 저장된 값과 같으면 -1 카운트 하여  전부 맞추면 그림0 처럼 "All Clear!!!" 라는 화면 뜨고 몇개만 맞추면 "개 맞추셨습니다" 라고 뜨며 모두 틀리면 "Game Over" 라는 메시지가 뜨게 됩니다.
</span>

```csharp
#region 화면 초기화
Thread.Sleep(100);
Console.Clear();

#endregion
```

<span style="font-size: 15px;">
   코드00 
</span>

<span style="font-size: 15px;">
   코드00 화면 초기화 코드는 반복문이 동작하면서 화면을 100/1000초로 화면을 지워주면서 화면의 잔상을 지워 줍니다.
</span>
